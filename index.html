<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Never cache. Ever. -->
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />
  <title>Pico y Placa Medell√≠n</title>
  <meta content="Pico y Placa Medell√≠n" property="og:site_name">
  <meta content="Pico y Placa Medell√≠n" property="og:title">
  <meta content="website" property="og:type">
  <meta name="description" content="Informaci√≥n diaria del Pico y Placa en Medell√≠n">
  <meta property="og:description" content="Informaci√≥n diaria del Pico y Placa en Medell√≠n">
  <meta content="http://www.picoyplaca.org" property="og:url">
  <link rel="source" href="https://github.com/nhocki/pico-y-placa-medellin" title="Source Code">
  <link rel="stylesheet" href="css/style.css">
</head>

<body id="container">

<h1 id="title"> Pico y Placa Medell√≠n</h1>

<div class="small"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdOiMNQ7oX1O4QySFOL1mS44Idg4-zykhQrcX7qaY7rEPxQjA/viewform" target="_blank">Recibe alerta cuando tengas pico y placa</a></div>

<section id="day" class="fit"></section>
<section id="car-plates" class="fit"></section>
<section id="bike-plates" class="fit"></section>

<div id='wrap'>
  <table id="full"></table>

  <span id='schedule' class='small'>7:00AM - 08:30AM &nbsp; & &nbsp; 5:30PM - 7:00PM</span>
  <a href='https://github.com/nhocki/pico-y-placa-medellin' class='small' target="_blank">
    Este sitio es open source
  </a>

  <p class='small'>
    <a href="http://siata.picoyplaca.org/" target="_blank">
      Ver la calidad del aire en Medell√≠n
    </a>
  </p>
</div>

<script type="text/javascript" >
  var days = [
    "Domingo",
    "Lunes",
    "Martes",
    "Mi√©rcoles",
    "Jueves",
    "Viernes",
    "S√°bado"
  ];

  var carStep = 4;
  var carNums = 4;
  var carStart = 2;

  var bikeStep = 2;
  var bikeNums = 2;
  var bikeStart = 2;

  var carPlates = ["No hay pico y placa"];
  var bikePlates = [""];

  for (let day = 0; day < 5; day++) {
    let cPlates = [];
    let bPlates = [];
    let start = ((day * carStep) + carStart) % 10;
    for (let i = 0; i < carNums; i++) {
      let num = (start + i) % 10;
      cPlates.push(num)
    }

    start = ((day * bikeStep) + bikeStart) % 10;
    for (let i = 0; i < bikeNums; i++) {
      let num = (start + i) % 10;
      bPlates.push(num)
    }
    bikePlates.push(bPlates.join(" - "))
    carPlates.push(cPlates.join(" - "))
  }

  carPlates.push("No hay pico y placa");
  bikePlates.push("");

  var even = [5, 19]
  var odd = [12, 26]

  var emergency = function (data, date) {
    // Emergency is only on Saturdays.
    day = date.getDay()
    if (day != 6) {
      return data[day];
    }

    month = date.getMonth()
    if (month != 9) { // only on october
      return data[day];
    }

    monthDay = date.getDate()
    if (even.includes(monthDay)) {
      return "0 - 2 - 4 - 6 - 8"
    }

    if (odd.includes(monthDay)) {
      return "1 - 3 - 5 - 7 - 9"
    }

    return data[day];
  }

  var date = new Date();
  var table = ""
  for (var i = 1; i <= 5; i++) {
    table += `<tr><td>${days[i]}</td><td>${carPlates[i]} &nbsp;&nbsp; |&nbsp;&nbsp; ${bikePlates[i]}</td></tr>`
  }

  document.getElementById("day").innerHTML = days[date.getDay()];
  document.getElementById("car-plates").innerHTML = "üöó  " + emergency(carPlates, date);
  document.getElementById("bike-plates").innerHTML = "üèç  " + emergency(bikePlates, date);
  document.getElementById("full").innerHTML = table;
</script>

<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '582021524b2ffa060b015ff8');
    t.setAttribute('data-track-path', 'https://track.gaug.es/track.gif');
    t.src = 'https://d36ee2fcip1434.cloudfront.net/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87129502-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
